{% extends 'base_auth.html' %} 
{% block title %}Inscription - Lopes Peinture{% endblock %} 
{% block meta_description %}
Créez votre compte Lopes Peinture pour demander des devis personnalisés et suivre
vos projets de peinture et décoration.
{% endblock %} 
{% block content %}
<!-- Header -->
<div class="text-center mb-8">
  <h2 class="text-3xl font-bold text-gray-900 mb-3">Rejoignez-nous</h2>
  <p class="text-gray-600 text-lg">Créez votre compte pour démarrer vos projets</p>
</div>

<!-- Messages d'alerte -->
{% if messages %}
<div class="mb-6 space-y-3" role="alert">
  {% for message in messages %}
  <div
    class="p-4 rounded-xl border-l-4 {% if message.tags == 'error' %}bg-red-50 border-red-400 text-red-800{% elif message.tags == 'warning' %}bg-yellow-50 border-yellow-400 text-yellow-800{% elif message.tags == 'success' %}bg-green-50 border-green-400 text-green-800{% else %}bg-blue-50 border-blue-400 text-blue-800{% endif %} shadow-sm"
  >
    <div class="flex items-center">
      <i
        class="fas {% if message.tags == 'error' %}fa-exclamation-circle{% elif message.tags == 'warning' %}fa-exclamation-triangle{% elif message.tags == 'success' %}fa-check-circle{% else %}fa-info-circle{% endif %} mr-3 text-lg flex-shrink-0"
      ></i>
      <div class="flex-1 font-medium">{{ message }}</div>
    </div>
  </div>
  {% endfor %}
</div>
{% endif %}

<!-- Formulaire d'inscription -->
<form method="post" class="space-y-5" id="register-form" novalidate>
  {% csrf_token %}

  <!-- Prénom et Nom -->
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div class="space-y-2">
      <label
        for="{{ form.first_name.id_for_label }}"
        class="block text-sm font-semibold text-gray-700"
      >
        Prénom <span class="text-red-500 ml-1">*</span>
      </label>
      <input
        type="text"
        id="{{ form.first_name.id_for_label }}"
        name="{{ form.first_name.html_name }}"
        value="{{ form.first_name.value|default:'' }}"
        placeholder="Jean"
        autocomplete="given-name"
        required
        class="form-input w-full px-4 py-3 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.first_name.errors %}error{% endif %}"
      />

      {% if form.first_name.errors %}
      <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
        <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
        <div>
          {% for error in form.first_name.errors %}
          <span class="block font-medium">{{ error }}</span>
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </div>

    <div class="space-y-2">
      <label
        for="{{ form.last_name.id_for_label }}"
        class="block text-sm font-semibold text-gray-700"
      >
        Nom <span class="text-red-500 ml-1">*</span>
      </label>
      <input
        type="text"
        id="{{ form.last_name.id_for_label }}"
        name="{{ form.last_name.html_name }}"
        value="{{ form.last_name.value|default:'' }}"
        placeholder="Dupont"
        autocomplete="family-name"
        required
        class="form-input w-full px-4 py-3 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.last_name.errors %}error{% endif %}"
      />

      {% if form.last_name.errors %}
      <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
        <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
        <div>
          {% for error in form.last_name.errors %}
          <span class="block font-medium">{{ error }}</span>
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Email -->
  <div class="space-y-2">
    <label for="{{ form.email.id_for_label }}" class="block text-sm font-semibold text-gray-700">
      <i class="fas fa-envelope mr-2 text-brand-primary"></i>
      Adresse email <span class="text-red-500 ml-1">*</span>
    </label>

    <div class="relative">
      <input
        type="email"
        id="{{ form.email.id_for_label }}"
        name="{{ form.email.html_name }}"
        value="{{ form.email.value|default:'' }}"
        placeholder="votre.email@exemple.com"
        autocomplete="email"
        required
        class="form-input w-full px-4 py-3 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.email.errors %}error{% endif %}"
      />

      <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
        <i class="fas fa-at text-gray-400 text-sm"></i>
      </div>
    </div>

    {% if form.email.errors %}
    <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
      <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
      <div>
        {% for error in form.email.errors %}
        <span class="block font-medium">{{ error }}</span>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>

  <!-- Telefone (se existir no form) -->
  {% if form.phone %}
  <div class="space-y-2">
    <label for="{{ form.phone.id_for_label }}" class="block text-sm font-semibold text-gray-700">
      <i class="fas fa-phone mr-2 text-brand-primary"></i>
      Téléphone
    </label>

    <div class="relative">
      <input
        type="tel"
        id="{{ form.phone.id_for_label }}"
        name="{{ form.phone.html_name }}"
        value="{{ form.phone.value|default:'' }}"
        placeholder="06 12 34 56 78"
        autocomplete="tel"
        class="form-input w-full px-4 py-3 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.phone.errors %}error{% endif %}"
      />

      <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
        <i class="fas fa-mobile-alt text-gray-400 text-sm"></i>
      </div>
    </div>

    {% if form.phone.errors %}
    <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
      <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
      <div>
        {% for error in form.phone.errors %}
        <span class="block font-medium">{{ error }}</span>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- Mot de passe -->
  <div class="space-y-2">
    <label
      for="{{ form.password1.id_for_label }}"
      class="block text-sm font-semibold text-gray-700"
    >
      <i class="fas fa-lock mr-2 text-brand-primary"></i>
      Mot de passe <span class="text-red-500 ml-1">*</span>
    </label>

    <div class="relative">
      <input
        type="password"
        id="{{ form.password1.id_for_label }}"
        name="{{ form.password1.html_name }}"
        placeholder="Choisissez un mot de passe sécurisé"
        autocomplete="new-password"
        required
        class="form-input w-full px-4 py-3 pr-12 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.password1.errors %}error{% endif %}"
      />

      <button
        type="button"
        class="absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none focus:text-brand-primary transition-colors duration-200"
        onclick="togglePassword('{{ form.password1.id_for_label }}', this)"
        aria-label="Afficher le mot de passe"
        tabindex="-1"
      >
        <i class="fas fa-eye text-sm"></i>
      </button>
    </div>

    {% if form.password1.errors %}
    <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
      <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
      <div>
        {% for error in form.password1.errors %}
        <span class="block font-medium">{{ error }}</span>
        {% endfor %}
      </div>
    </div>
    {% else %}
    <div class="text-sm text-gray-600 mt-2">
      <i class="fas fa-info-circle mr-1 text-xs"></i>
      Minimum 8 caractères avec lettres et chiffres
    </div>
    {% endif %}
  </div>

  <!-- Confirmer mot de passe -->
  <div class="space-y-2">
    <label
      for="{{ form.password2.id_for_label }}"
      class="block text-sm font-semibold text-gray-700"
    >
      <i class="fas fa-lock mr-2 text-brand-primary"></i>
      Confirmer le mot de passe <span class="text-red-500 ml-1">*</span>
    </label>

    <div class="relative">
      <input
        type="password"
        id="{{ form.password2.id_for_label }}"
        name="{{ form.password2.html_name }}"
        placeholder="Répétez votre mot de passe"
        autocomplete="new-password"
        required
        class="form-input w-full px-4 py-3 pr-12 text-gray-900 bg-white border-2 border-gray-300 rounded-xl shadow-sm placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-brand-primary transition-all duration-200 {% if form.password2.errors %}error{% endif %}"
      />

      <button
        type="button"
        class="absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none focus:text-brand-primary transition-colors duration-200"
        onclick="togglePassword('{{ form.password2.id_for_label }}', this)"
        aria-label="Afficher le mot de passe"
        tabindex="-1"
      >
        <i class="fas fa-eye text-sm"></i>
      </button>
    </div>

    {% if form.password2.errors %}
    <div class="flex items-center text-sm text-red-600 mt-2" role="alert">
      <i class="fas fa-exclamation-circle mr-2 flex-shrink-0"></i>
      <div>
        {% for error in form.password2.errors %}
        <span class="block font-medium">{{ error }}</span>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>

  <!-- Conditions d'utilisation -->
  <div class="space-y-4">
    <div class="flex items-start">
      <input
        id="terms_conditions"
        name="terms_conditions"
        type="checkbox"
        required
        class="h-4 w-4 text-brand-primary focus:ring-brand-primary focus:ring-offset-0 border-gray-300 rounded transition-colors duration-200 mt-1"
      />
      <label for="terms_conditions" class="ml-3 text-sm text-gray-700 cursor-pointer">
        J'accepte les
        <a
          href="#"
          class="text-brand-primary hover:text-brand-secondary font-semibold focus:outline-none focus:underline transition-colors duration-200"
        >
          conditions d'utilisation
        </a>
        et la
        <a
          href="#"
          class="text-brand-primary hover:text-brand-secondary font-semibold focus:outline-none focus:underline transition-colors duration-200"
        >
          politique de confidentialité
        </a>
        <span class="text-red-500 ml-1">*</span>
      </label>
    </div>

    <div class="flex items-start">
      <input
        id="newsletter_consent"
        name="newsletter_consent"
        type="checkbox"
        class="h-4 w-4 text-brand-primary focus:ring-brand-primary focus:ring-offset-0 border-gray-300 rounded transition-colors duration-200 mt-1"
      />
      <label for="newsletter_consent" class="ml-3 text-sm text-gray-700 cursor-pointer">
        Je souhaite recevoir les actualités et offres spéciales de Lopes Peinture
      </label>
    </div>
  </div>

  <!-- Bouton de soumission -->
  <button
    type="submit"
    class="btn-primary w-full flex justify-center items-center py-4 px-6 text-white font-semibold text-base rounded-xl shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-brand-primary focus:ring-opacity-50 disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-200"
    id="submit-button"
  >
    <i class="fas fa-user-plus mr-3 text-lg"></i>
    <span id="submit-text">Créer mon compte</span>
  </button>
</form>
{% endblock %} {% block navigation_links %}
<div class="text-center space-y-4">
  <div class="p-6 bg-gray-100 rounded-xl">
    <p class="text-gray-700 font-medium mb-3">
      <i class="fas fa-sign-in-alt mr-2 text-brand-primary"></i>
      Déjà client ?
    </p>
    <p class="text-gray-600 text-sm mb-4">
      Connectez-vous à votre espace pour consulter vos projets et devis.
    </p>
    <a
      href="{% url 'accounts:login' %}"
      class="inline-flex items-center justify-center px-6 py-3 border-2 border-brand-primary text-brand-primary font-semibold rounded-xl hover:bg-brand-primary hover:text-white focus:outline-none focus:ring-4 focus:ring-brand-primary focus:ring-opacity-50 transition-all duration-200"
    >
      <i class="fas fa-arrow-right mr-2"></i>
      Se connecter
    </a>
  </div>

  <div class="pt-4 border-t border-gray-200">
    <a
      href="/"
      class="inline-flex items-center text-gray-500 hover:text-brand-primary focus:outline-none focus:text-brand-primary transition-colors duration-200 font-medium"
    >
      <i class="fas fa-arrow-left mr-2"></i>
      Retour à l'accueil
    </a>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('register-form');
    const submitButton = document.getElementById('submit-button');
    const submitText = document.getElementById('submit-text');
    const termsCheckbox = document.getElementById('terms_conditions');

    // Enable/disable submit button based on terms acceptance
    termsCheckbox.addEventListener('change', function () {
      submitButton.disabled = !this.checked;
      submitButton.classList.toggle('opacity-50', !this.checked);
    });

    // Initial state
    submitButton.disabled = !termsCheckbox.checked;
    submitButton.classList.toggle('opacity-50', !termsCheckbox.checked);
  });
</script>
{% endblock %}
